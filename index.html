<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Race Condition Running</title>
  <link rel='stylesheet' type='text/css' href='style.css'>
  <script src="jquery.min.js"></script>

  <!-- favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>

<div style='float: right;'>
  <img src='img/rcc-logo.png' width='150' alt='RCC Logo'>
</div>
<h1 style='padding-top: 20px;'>
  Race Condition Running
  <a target="_blank"
     href='https://www.facebook.com/groups/raceconditionrunning/'>
    <img src='img/facebook-icon.png' height='30px'>
  </a>
</h1>
<div style='clear: both;'></div>

<h2>
  Schedule
  <!-- add a query param on ics link to bypass cache for testing (e.g. ?foo) -->
  <a target="_blank"
     href="http://www.google.com/calendar/render?cid=http://raceconditionrunning.com/rcc.ics">
    <img src='img/cal-icon.png' height='25px'>
  </a>
</h2>

<p>
  If you are having trouble accessing the calendar, try manually by adding
  the following url to your calendar application:
  <a href = "http://raceconditionrunning.com/rcc.ics"> http://raceconditionrunning.com/rcc.ics </a>
</p>

<h3>Weekend Haiku</h3>

<p style='font-style: italic; line-height: 25px; margin-left: 20px;'>
  meet at run start point<br>
  chit chat conversation pace<br>
  brunch nearby after
</p>
<p>
  Please let us know on the UW CSE Slack or RCR Facebook page
  if you're joining and arrive 10 minutes before run!
</p>
<div id='schedule'>
  <table id='runs'></table>
</div>

<h3>Tuesday</h3>

<p>Meet in CSE atrium at 5:00pm and do 3-4 miles.</p>

<h3>Thursday</h3>

<p>Meet in CSE atrium at 5:00pm and do 6-8 miles.</p>

<h2>Photo Album</h2>
<p>Check out our photos <a href = "https://photos.app.goo.gl/DW9MRhNTi2vLwYor1">here</a>!</p>

<p style='padding-top: 20px;'>
<div class="row">
  <div class="column">
    <img src='img/race-condition-running2.jpg' style="width:100%">
  </div>
  <div class="column">
    <img src='img/race-condition-running1.jpg' style="width:100%">
  </div>
</div>
</p>

<h2>Routes</h2>

<div id='routes'>
  <ul id='route-list'></ul>
</div>


<script>
$(function() {
  var ROUTES;
  var SCHED;

  function lkup(uid) {
    for(var i = 0; i < ROUTES.length; i++) {
      var r = ROUTES[i];
      if(r.uid == uid) {
        return r;
      }
    }
    console.log("lkup: could not find " + uid);
  }

  var monthName =
    [ "Jan", "Feb", "Mar", "Apr", "May", "Jun"
    , "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
    ];


  function main() {
    dispRoutes();
    dispSched();
  }

  function dispRoutes() {
    for(var i = 0; i < ROUTES.length; i++) {
      $("<li/>", {
        html: fmtRoute(ROUTES[i])
      }).appendTo("#route-list");
    }
  }

  function fmtRoute(r) {
    var d = (Math.round(r.dist * 100) / 100).toFixed(2);
    return "<a target='_blank' href='" + r.map + "'>"
         + "<span class='fll'>" + r.name + "</span>"
         + "<span class='flr'>" + d + "</span>"
         + "</a>";
  }

  function dispSched() {
    var today = new Date();
    var afterNext = false;

    var entries = [];
    for(var i = 0; i < SCHED.length; i++) {
      var run = SCHED[i];
      var date = new Date(run.date);

      // figure age with date after run
      var ndate = new Date(run.date);
      ndate.setDate(ndate.getDate() + 1);

      var age = "past";
      if(today < ndate) {
        if(!afterNext) {
          age = "next";
          afterNext = true;
        } else {
          age = "future";
        }
      }

      for(var j = 0; j < run.plan.length; j++) {
        var phase = run.plan[j];
        var route = lkup(phase.route);
        var entry = { date: ""
                    , time: phase.time
                    , name: route.name
                    , map:  route.map
                    , dist: route.dist
                    , age:  age
                    };
        if(j == 0) {
          var M = monthName[date.getMonth()];
          var D = date.getDate() + 1;
          entry.date = M + " " + D;
        }
        entries.push(entry);
      }
      entries.push(null);
    }

    for(var i = 0; i < entries.length; i++) {
      var e = entries[i];
      var row = "";
      if(e == null) {
        row = "<tr class='spacer'></tr>";
      } else {
        row = "<tr class='" + e.age + "'>"
            + "<td class='date'>" + e.date + "</td>"
            + "<td class='time'>" + e.time + "</td>"
            + "<td nowrap>"
            +    "<a target='_blank' href='" + e.map + "'>"
            +    e.name +  "</a>"
            +    "&nbsp; (" + e.dist + ")"
            + "</td>"
            + "</tr>";
      }
      $("#runs").append(row);
    }
  }

  $.getJSON("routedb.json", function(data) {
    ROUTES = data.routes;
    $.getJSON("sched.json", function(data) {
      SCHED = data.sched;
      main();
    })
  });
});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84537680-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
