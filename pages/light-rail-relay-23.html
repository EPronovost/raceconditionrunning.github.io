---
permalink: light-rail-relay-23/
redirect_from:
- /lrr/
- /light-rail-relay/
- /lrr23/
team_registration_link: https://forms.gle/rPGW6fWT4wytm7be7
registration_link: https://forms.gle/mudG4DHJFhPuqYbV6
---
<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>Light Rail Relay 2023</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Marathon relay along the Link Line 1 happening September 30th, 2023.">
    <meta name="theme-color" content="#000000">
    <meta property="og:image" content="{{ site.baseurl }}/img/lrr23/lrr-og-banner.png">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ site.baseurl }}/light-rail-relay-23/">
    <meta property="og:title" content="Light Rail Relay 2023">
    <meta property="og:description" content="Marathon relay along the Link Line 1 happening September 30th, 2023.">
    <script src="https://cdn.jsdelivr.net/npm/maplibre-gl@3.3.1/dist/maplibre-gl.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/maplibre-gl@3.3.1/dist/maplibre-gl.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/js/bootstrap.bundle.min.js" integrity="sha512-ToL6UYWePxjhDQKNioSi4AyJ5KkRxY+F1+Fi7Jgh0Hp5Kk2/s8FD7zusJDdonfe5B00Qw+B8taXxF6CFLnqNCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.min.css" rel="stylesheet">
    <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator_bootstrap5.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>
    <!--script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.js" ></script>
    <script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/css/bootstrap.min.css" integrity="sha512-Z/def5z5u2aR89OuzYcxmDJ0Bnd5V1cKqBEbvLOiUNWdg9PQeXVvXLI90SE4QOHGlfLqUnDNVAYyZi8UwUTmWQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.css" integrity="sha512-qveKnGrvOChbSzAdtSs8p69eoLegyh+1hwOMbmpCViIwj7rn4oJjdmMvWOuyQlTOZgTlZA0N2PXA7iA8/2TUYA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.js" integrity="sha512-UOJe4paV6hYWBnS0c9GnIRH8PLm2nFK22uhfAvsTIqd3uwnWsVri1OPn5fJYdLtGY3wB11LGHJ4yPU1WFJeBYQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


</head>
<style>
    @font-face {
        font-family: "Seattle Transit Dot Matrix 15";
        src: local("seattle_transit_dot_matrix_15"),
        url("https://files.nickwalker.us/seattle_transit_dot_matrix_15.woff2") format("woff2");
        /* Hosted externally until finalized
        url("{{ base_url }}/fonts/seattle_transit_dot_matrix_15.woff2") format("woff2");*/
    }
    @font-face {
        font-family: "Seattle Transit Dot Matrix 7";
        src: local("seattle_transit_dot_matrix_7"),
        url("https://files.nickwalker.us/seattle_transit_dot_matrix_7.woff2") format("woff2");
        /*url("{{ base_url }}/fonts/seattle_transit_dot_matrix_7.woff2") format("woff2")*/;
    }

    :root {
        --theme-primary-color: #5fac56;
        --theme-primary-color-subdued: #51804d;
        --theme-primary-color-bright: #6cc462;
        --bs-link-hover-color: #6cc462;
        --dot-size: clamp(0.125rem, 0.1125rem + .26666667vw, .5333333rem);
        --bs-body-bg: #010101;
        --bs-body-color: #fefefe;
    }

    body {
        margin: 0;
        font-family: var(--bs-font-sans-serif);
        font-size: 16px;
        line-height: 1.5;
    }

    ::selection {
        background: var(--theme-primary-color-subdued);
    }

    #title ::selection {
        background: #333;
    }

    a {
        color: var(--theme-primary-color);
    }

    ul {
        /* Don't jam bullet at edge of screen on mobile */
        padding-left: 1rem
    }

    @media screen and (min-width: 700px) {
        ul {
            padding-left: 0;
        }
    }

    .anchor-link {
        padding: 0 .175rem;
        font-weight: 400;
        color: var(--theme-primary-color-bright);
        text-decoration: none;
        opacity: 0;
        transition: color 0.15s ease-in-out,opacity 0.15s ease-in-out;
    }

    .anchor-link::after {
        content: "#";
    }

    .anchor-link:focus, .anchor-link:hover, :hover > .anchor-link, :target > .anchor-link {
        text-decoration: none;
        opacity: 1;
    }

    .imprint a {
        text-decoration: none;
    }

    .imprint img {
        width: 100px;
        opacity: .5;
        filter: invert();
    }

    #map-container {
        height: 100%;
    }
    #map {
        height: 70vh;
    }

    dt {
        font-weight: bold;
    }

    dd {
        margin-left: 0;
        margin-bottom: 1rem
    }

    header {
        margin-bottom: 1rem;
    }

    section {
        margin-bottom: 4rem;
    }

    .btn {
        border-radius: 0;
    }

    .btn-outline-primary {
        --bs-btn-color: var(--theme-primary-color);
        --bs-btn-hover-bg: var(--theme-primary-color-bright);
        --bs-btn-hover-color: var(--bs-body-color);
        --bs-btn-hover-border-color: transparent;
        --bs-btn-active-bg: var(--theme-primary-color);
        --bs-btn-active-border-color: var(--theme-primary-color);
        --bs-btn-active-color: #eee;
        --bs-btn-border-color: var(--theme-primary-color-bright);
        --bs-btn-focus-shadow-rgb: 255, 255, 255
    }

    .maplibregl-map {
        font-family: var(--bs-font-sans-serif);
        font-size: 1rem;
    }

    .maplibregl-popup-content {
        font-size: 1rem;
        --bs-body-color: black;
        color: black;
    }

    .maplibregl-popup-close-button {
        color: black;
    }

    .maplibregl-popup-content h3 {
        font-size: 1.25rem;
        margin-top: 0;
        margin-bottom: .25rem;
    }
    .maplibregl-popup-content h4 {
        font-size: 1rem;
        margin-top: 0;
        margin-bottom: .5rem;
    }

    .maplibregl-popup-content
     {
        background-color: rgba(255, 255, 255, 0.6);
        -webkit-backdrop-filter: blur(4px);
        backdrop-filter: blur(4px);
    }

    .exchange-name-popup a {
        color: var(--bs-body-color);
        text-decoration-color: var(--theme-primary-color);
        text-decoration-thickness: 2px;
        font-weight: 600;
    }

    .exchange-name-popup .maplibregl-popup-tip {
        border-right-color: rgba(255, 255, 255, 0.6);
    }
    .leg-popup .maplibregl-popup-tip {
        display: none;
    }

    .exchange-name-popup .maplibregl-popup-close-button {
        display: none;
    }

    .mapboxgl-ctrl-attrib.mapboxgl-compact, .maplibregl-ctrl-attrib.maplibregl-compact {
        background-color: rgba(255, 255, 255, 0.6);
        -webkit-backdrop-filter: blur(4px);
        backdrop-filter: blur(4px);
    }

    .maplibregl-map:focus:focus-visible,
    .maplibregl-ctrl-group button:focus:focus-visible {
        outline: none;
        box-shadow: 0 0 0 0.25rem var(--theme-primary-color-subdued);
    }

    footer {
        margin: 6rem 0 6rem 0;
    }

    .container {
        max-width: 700px;
    }

    #finish-row td {
        font-weight: bold;
    }

    #countdown .container {
        max-width: none;
    }

    figure {
        max-width: 1200px;
        margin: 0 auto 2rem auto;
    }

    hr {
        width: 8rem;
        margin: 4rem auto;
        display: block;
        border: 1px solid var(--bs-secondary-color);
    }

    header {
        margin: 0 auto;

    }

    .platform-sign {
        max-width: calc(var(--dot-size) * 130);
        box-sizing: content-box;
        padding: calc(var(--dot-size) * 2);
    }
    section#title .subheader, section#title .imprint {
        max-width: calc(var(--dot-size) * 130);
        text-align: left;
        font-weight: 300;
    }

    .subheader p, .subheader p a {
        color: grey;
    }

    .dot-matrix-background {
        background-image: radial-gradient(rgba(62,49,34,.15) 50%, transparent 50%);
        background-size: calc(var(--dot-size) * 1.001) calc(var(--dot-size) * 1.001);
        background-position: -.4px .4px;
    }


    .dot-matrix {
        text-shadow:   0 0 10px rgba(255,220,75,.3), 0 0 20px rgba(255,220,75,.6);
        color: orange;
        text-align: left;
        margin-bottom: 0;
    }

    .dot-matrix::selection {
        background: #333;
    }

    .dot-matrix-green {
        text-shadow:   0 0 10px rgba(95,172,86,.3), 0 0 20px rgba(95,172,86,.6);
        color: var(--theme-primary-color);
    }


    .dot-matrix.mb-1 {
        margin-bottom: var(--dot-size);
    }

    .dot-matrix-15 {
        font-family: "Seattle Transit Dot Matrix 15";
        font-size: calc(var(--dot-size) * 15);
        line-height: calc(1 + 1/15);
    }

    .dot-matrix-7 {
        font-family: "Seattle Transit Dot Matrix 7";
        font-size: calc(var(--dot-size) * 7);
        line-height: calc(1 + 1/7);
    }

    .accordion-item ul {
        padding-left: 1rem;
    }

    .accordion {
        --bs-accordion-btn-focus-border-color: var(--theme-primary-color-subdued);
        --bs-accordion-btn-focus-box-shadow: 0 0 0 0.25rem var(--theme-primary-color-subdued);
        --bs-accordion-bg: #111;
        --bs-accordion-active-color: var(--bs-emphasis-color);
        --bs-accordion-active-bg: #333;
    }
    .accordion-item {
        border-bottom: 1px solid #666;
    }

    .accordion-button::after {
        filter: saturate(0%);
    }

    .tabulator,
    .tabulator .tabulator-header .tabulator-col,
    .tabulator .tabulator-header,
    .tabulator .tabulator-tableholder .tabulator-table,
    .tabulator .tabulator-footer,
    .tabulator .tabulator-footer .tabulator-calcs-holder,
    .tabulator .tabulator-footer .tabulator-calcs-holder .tabulator-row{
        background-color: transparent !important;
    }

    .tabulator {
        color: var(--bs-body-color);
    }

    .tabulator-row.tabulator-group {
        background-color: rgba(255, 255, 255, 0.075) !important;
    }

    .tabulator .tabulator-tableholder .tabulator-table .tabulator-row.tabulator-calcs {
        background-color: transparent !important;
    }

    .tabulator-row, .tabulator-row.tabulator-row-even {
        background-color: transparent;
    }

    .tabulator-row,
    .tabulator .tabulator-header {
        border: none;
    }

    .tabulator-row .tabulator-responsive-collapse {
        border-top: 0px;
        padding-bottom: 1rem;
        white-space: normal;
    }
    .tabulator-responsive-collapse strong {
        font-weight: 500;
    }

    .tabulator .tabulator-footer {
        border: none !important;
    }

    .tabulator .tabulator-footer .tabulator-calcs-holder {
        border: none;
        border-top: 1px solid #AAA;
    }

    .leg-leader {
        font-weight: 700;
    }

    .first-leg {
        text-decoration: underline;
    }
    #leg-details-table h6, #leg-details-table .leg-number {
        color: var(--bs-secondary-color);
    }
    #leg-details-table h5 a {
        color: var(--bs-body-color);
        text-decoration-color: var(--theme-primary-color);
    }

    #leg-calculator {
        border: 1px solid #111;
    }

    .noUi-connect {
        background-color: var(--theme-primary-color);
    }
    .noUi-value {
        display: none; /* No tick labels */
    }
    .noUi-target {
        background: #333;
        border-radius: 0;
        border: 1px solid var(--bs-dark-border-subtle);
        box-shadow: none;
    }

    .noUi-handle {
        box-shadow: none;
    }

    .noUi-marker-large {
        background-color: #555;
    }
    .noUi-tooltip {
        width: 2rem;
        height: 2rem;
        border-radius: 1rem;
        padding: 3px 0 0 0;
    }

    .noUi-horizontal .noUi-tooltip {
        bottom: 130%;
    }


    .imprint {
        text-align: center;
        margin-bottom: 1.5rem;
        font-style: italic;
        font-weight: 300;
    }

    .imprint a {
        text-decoration: none;
        color: #666;
    }

    .imprint img {
        width: 100px;
        opacity: .5;
    }

</style>
<body>

<section id="title">
    <div class="black-bg pt-4 pb-2">

        <header class="platform-sign dot-matrix-background px-2 px-sm-0">

            <div class="container-xxl px-0">
                <div class="logo-symbols dot-matrix dot-matrix-7 mb-1"><span class="dot-matrix-green">&#x2460;</span>&thinsp;-&#127939;&#127939;&thinsp;-&thinsp;&#128648;&thinsp;&#x2192;</div>

                <h1 class="dot-matrix dot-matrix-15 mb-1">Light Rail Relay</h1>

                <div id="countdown" class="dot-matrix dot-matrix-7 ">
                        Arriving <span id="static-count" style="">soon</span><span id="dynamic-count"
                                                                          style="display:none">in
            <span id="days"></span>d&nbsp;<span id="day-plural"></span><span id="hours"></span>h&nbsp;<span id="minutes"></span>min<span class="flashing">.</span></span>

                </div>
                <div id="countdown-ended" style="display: none" class="dot-matrix dot-matrix-7">
                    September 30th, 2023
                </div>
            </div>
        </header>
        <div class="subheader mx-auto px-2 px-sm-0">
            <p>Marathon relay along Seattle's Link Light Rail by <a href="{{ site.baseurl }}/" class="fst-italic text-decoration-none">Race Condition Running</a>. <br/>08:30 September 30th</p>

            <div class="button-container">
                <a href="{{ page.registration_link }}" class="btn btn-outline btn-outline-primary btn-lg me-2" data-bs-toggle="tooltip" data-bs-title="by 9-27" data-bs-placement="bottom">Sign Up
                </a>
                <a href="{{ page.team_registration_link }}" class="btn btn-outline btn-outline-primary btn-lg" data-bs-toggle="tooltip" data-bs-title="by 9-25" data-bs-placement="bottom">Add Team
  </span></a>
                <!--a href="https://docs.google.com/spreadsheets/d/1f6813y3qSEZf9UtAaosDixreD4fjyMbx-jMlCBcRQjc/edit?usp=sharing" class="btn hero-button">Follow Along</a></div-->
                <!--div class="button-container"><a href="#epilogue" class="btn hero-button">Read Epilogue</a-->
                </div>
            </div>
        </div>
    </section>


    <section id="map">
        <div id="map-container" tabindex="0"></div>

    </section>

    <section>
        <div class="container pb-4 mb-4">
            <div class="d-flex flex-column flex-sm-row justify-content-between align-items-baseline">
                <h2 id="route">Route <a href="#route" class="anchor-link" aria-label="Link to this section. Route"></a></h2>
                <a href="#" class="btn btn-outline-primary mb-3 m-sm-0 " id="download-route-gpx-btn" hidden>Download Route GPX</a>
            </div>
            <h5>18 legs - 28.10 mi ↑2200ft ↓2300ft</h5>
            <p>The relay will start at Angle Lake station and follow the entire operational line to Northgate, with
                visits to each station on the way. The route passes through Sea-Tac, Tukwila, and Bryn-Mawr Skyway before traversing the length of Seattle.</p>


            <div id="leg-calculator" class="mb-3 p-2 p-lg-4" style="display: none">
                <h6 class="text-secondary">Segment Calculator</h6>
                <div id="leg-calculator-description"></div>
                <div class="mx-3">
                <div class="leg-range-input mt-5 mb-5" id="leg-calculator-slider"></div>
                </div>
            </div>


            <div id="leg-details-accordion" class="accordion accordion-flush">
                <div class="accordion-item">
                    <h3 class="accordion-header" id="leg-details-heading">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#leg-details" aria-expanded="true" aria-controls="leg-details">See all leg details
                        </button>
                    </h3>
                    <div id="leg-details" class="accordion-collapse collapse" aria-labelledby="leg-details-heading"
                         data-bs-parent="#leg-details-accordion">

                        <div class="accordion-body">
                            <div id="leg-details-table"></div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </section>


    <section>
        <div class="container">
            <h2 id="faq">FAQ <a href="#faq" class="anchor-link" aria-label="Link to this section. FAQ"></a></h2>

            <div id="faq-accordion" class="accordion accordion-flush mb-4">
                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingOne">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqOne" aria-expanded="true" aria-controls="faqOne">
                            Why do this?
                        </button>
                    </h3>
                    <div id="faqOne" class="accordion-collapse collapse" aria-labelledby="faq-headingOne"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            It's a chance to experience different parts of the city, and there's no better way to appreciate what Link does for Seattle than to run the route. If you're the competitive type, you may like the idea <a href="https://www.youtube.com/watch?v=OMNFRFUM4IM">of</a> <a href="https://www.youtube.com/watch?v=TaMiV3Wus9c">racing</a> <a href="https://www.youtube.com/watch?v=3x3HDTY919g">trains</a>. Or maybe you're an ultra-runner keen on establishing Seattle's first great urban FKT. Check out <a href="{{ site.baseurl }}/light-rail-relay-22#epilogue">the photos from last year</a> if you still need convincing.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqTwo" aria-expanded="true" aria-controls="faqTwo">Who can participate?
                        </button>
                    </h3>
                    <div id="faqTwo" class="accordion-collapse collapse" aria-labelledby="faq-headingTwo"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            <p>Anyone in the CSE community is welcome to run as part of the Race Condition Running team. See the <a href="#faq-rcr">section below</a> for details about the team.</p>

                            <p>New for this year, we're also inviting other running groups who would like to form teams to complete the relay.  If you're interested in forming a team, please see the instructions below.</p>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqFour" aria-expanded="true" aria-controls="faqFour">How can I make a team?
                        </button>
                    </h3>
                    <div id="faqFour" class="accordion-collapse collapse" aria-labelledby="faq-headingFour"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            <p>Anyone who would like to form a team is welcome. There are three categories for results purposes: <b>Competitive</b> for teams of four, <b>Ultra</b> for teams of one, and <b>Open</b> for all other formats. All teams will:</p>
                            <ul>
                            <li>Ensure all members are registered.</li>
                            <li>Have a runner present at the Angle Lake Station platform at 08:30 on the morning of the event to receive their baton.</li>
                            <li>Carry their baton through all 19 stations.</li>
                            <li>Document station visits with photos.</li>
                            <li>Gather and submit station photos after the event.</li>
                        </ul>

                            <p>Teams are responsible for their own logistics and support during the event.</p>

                            <p>If you're interested in forming a team, please complete the <a href="{{ page.team_registration_link}}">team signup</a>. There is no cost to register. If there are more teams than we can handle, we may ask any clubs fielding multiple teams to consolidate. Once your team is confirmed, you and your runners will be able to use the main <a href="{{ page.registration_link }}">sign-up form</a>.</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingNine">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqNine" aria-expanded="true" aria-controls="faqNine">
                            How does timing work?
                        </button>
                    </h3>
                    <div id="faqNine" class="accordion-collapse collapse" aria-labelledby="faq-headingNine"
                         data-bs-parent="#faq-accordion">
                        <div class="accordion-body">
                            If you want an <i>official</i> time, your team captain will need to submit a set of 19 station photos with time metadata. We'll verify the photos and post the results. The photos you share will not be posted.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingTwelve">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqTwelve" aria-expanded="true" aria-controls="faqTwelve">
                            Can we walk?
                        </button>
                    </h3>
                    <div id="faqTwelve" class="accordion-collapse collapse" aria-labelledby="faq-headingTwelve"
                         data-bs-parent="#faq-accordion">
                        <div class="accordion-body">
                            Yes, your team can walk for any or all of the event. There will be about <a href="https://www.timeanddate.com/sun/usa/seattle?month=9">12 hours of usable daylight</a> making it manageable to complete the route at a modest walking pace. Please mark your estimated time appropriately when registering as walking teams will be given an earlier start.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqFive" aria-expanded="true" aria-controls="faqFive">What counts as a station photo?
                        </button>
                    </h3>
                    <div id="faqFive" class="accordion-collapse collapse" aria-labelledby="faq-headingFive"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            Your baton must be in the photo. It must be possible to tell that the photo was taken from within 100m of the station platform as the crow flies. You don't need to take the photo on the platform or even from within the fare zone! Consider using the <a href="https://www.soundtransit.org/sites/default/files/2016_start-on-link-map.pdf">station art</a> or signage.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingEleven">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqEleven" aria-expanded="true" aria-controls="faqEleven">
                            Do we have to follow the route?
                        </button>
                    </h3>
                    <div id="faqEleven" class="accordion-collapse collapse" aria-labelledby="faq-headingEleven"
                         data-bs-parent="#faq-accordion">
                        <div class="accordion-body">
                            We strongly recommend you follow the given route. We've run it before and assembled <a href="#route">notes on what to expect</a>. That said, the course is not monitored, and we will only be checking station photos. You can run alternative routes at your own peril.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqThree" aria-expanded="true" aria-controls="faqThree">How do we assign legs?
                        </button>
                    </h3>
                    <div id="faqThree" class="accordion-collapse collapse" aria-labelledby="faq-headingThree"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            <h5>Competitive Teams</h5>
                            <p>You must have exactly four runners each running at least one leg. So you may exchange as few as three times or as many times as there are stations. If your goal is to go fast, you probably want to break the distance evenly, but you'll have to weigh whether to cycle runners more frequently (risking botched exchanges) against running for longer blocks.</p>
                            <h5>Open Teams</h5>
                            <p>There are no constraints. The RCR team treats the event like a big long-run, with multiple runners on each leg. See our previous schedules from <a href="{{ site.baseurl }}/light-rail-relay-21#schedule">2021</a> and <a href="{{ site.baseurl }}/light-rail-relay-22#schedule">2022</a> to get the idea. In any case, we'll collect your runners' preferences and send them to you along with a recommended schedule.</p></div>
                    </div>
                </div>


                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingSeven">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqSeven" aria-expanded="true" aria-controls="faqSeven">Is this safe?
                        </button>
                    </h3>
                    <div id="faqSeven" class="accordion-collapse collapse" aria-labelledby="faq-headingSeven"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            Running the Light Rail Relay involves the same kinds of danger that you would encounter on any run in Seattle. Although unlikely, there is risk of harm from vehicle traffic, falling, weather, or medical complications. The course is open and you are responsible for your own safety. During registration, you will be asked to sign a liability waiver acknowledging these risks. That being said, the organizers have run the route multiple times without incident. Click around the route map to see our notes.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingEight">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqEight" aria-expanded="true" aria-controls="faqEight">
                            How do we manage our team's logistics?
                        </button>
                    </h3>
                    <div id="faqEight" class="accordion-collapse collapse" aria-labelledby="faq-headingEight"
                         data-bs-parent="#faq-accordion">

                        <div class="accordion-body">
                            <h5>Competitive teams</h5>
                            <p>A group chat is probably sufficient, depending on how you decide to divide up legs. Consider having the next runner bring something for the previous to eat and drink.</p>
                            <h5>Open teams</h5>
                            <p>Make a schedule and stick to it. We'll provide a recommended schedule based on your runners' preferences, but it's up to the team captain (person who added the team) to finalize and distribute assignments. We'll also provide a Google Sheets spreadsheet which you can use to manage live tracking during the event. You can see RCR's from <a href="https://docs.google.com/spreadsheets/d/1wFvyhVMUVqJ3DTGJMr0fr9nrX8zU8nl4uux4AY_H01E/edit?usp=sharing">2021</a> and <a href="https://docs.google.com/spreadsheets/d/1rd9Si3BcPgqt3fWxoHnuUB0rnN00XLtziMaHSPpQt14/edit#gid=0">2022</a> as examples.</p>
                            <h5>Ultra teams</h5>
                            <p>The route is only slightly longer than a marathon, making it easy to run unsupported. Otherwise, there are lots of shops along the way for water and food.</p>
                            <h5>All teams</h5>
                            <p>Exchanges: The easiest way to manage exchanges is to meet on the surface level at the exact points marked on the route then take a photo with the nearest <a href="https://www.soundtransit.org/sites/default/files/2016_start-on-link-map.pdf">station art</a> or signage.</p>
                            <p>Getting around: Stations are conveniently accessible via light rail and other transit services. See <a href="https://seattletransitblog.com/seattle-for-visitors/">Seattle Transit Blog's page</a> for a refresher on how to get around using transit, and check the <a href="https://support.myorca.com/hc/en-us/articles/10743519362317-Visitor-s-Guide-to-Using-Public-Transit-in-the-Seattle-area">ORCA site</a> for recommendations on how to purchase fares. UW students can ride for free using their Husky IDs.</p>
                        </div>
                    </div>
                </div>


                <div class="accordion-item">
                    <h3 class="accordion-header" id="faq-headingTen">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faqTen" aria-expanded="true" aria-controls="faqTen">
                            I have a different question.
                        </button>
                    </h3>
                    <div id="faqTen" class="accordion-collapse collapse" aria-labelledby="faq-headingTen"
                         data-bs-parent="#faq-accordion">
                        <div class="accordion-body">
                            <a href="mailto:nick.s.walker@icloud.com">Ask over email.</a>
                        </div>
                    </div>
                </div>

                <!--div class="accordion-item">
                <h3 class="accordion-header" id="faq-headingEight">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faqEight" aria-expanded="true" aria-controls="faqEight">
                        Is there anything planned for after the run?
                    </button>
                </h3>
                <div id="faqEight" class="accordion-collapse collapse" aria-labelledby="faq-headingEight"
                     data-bs-parent="#faq-accordion">

                    <div class="accordion-body">
                        We are planning to enjoy the <a href="https://udistrictseattle.com/udistrictfoodwalk">U-District
                        Food Walk and Street Party</a> after the conclusion of the relay at 5:00PM. According to the U-District Partnership,
                        this year's food walk will have an "After Party" with "$4 drink specials from your favorite
                        neighborhood establishments between 6pm-10pm, along with a breakdancing competition, outdoor music,
                        and dance party right on the Ave."
                    </div>
                </div>
            </div-->

            </div>

        <h4 id="faq-rcr">RCR Team <a href="#faq-rcr" class="anchor-link" aria-label="Link to this section. RCR FAQ"></a></h4>

        <p>RCR is participating in the <b>Open Category</b> with multiple runners assigned to each leg.</p>
        <div id="faq-rcr-accordion" class="accordion accordion-flush">
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrTwo" aria-expanded="true" aria-controls="faq-rcrTwo">Who can join the RCR team?
                    </button>
                </h3>
                <div id="faq-rcrTwo" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingTwo"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        <p>Anyone in the CSE community is welcome to run as part of the Race Condition Running team. We interpret this broadly.</p>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrThree" aria-expanded="true" aria-controls="faq-rcrThree">How far do I need to run?
                    </button>
                </h3>
                <div id="faq-rcrThree" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingThree"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">You can choose how far, and we'll be able to accommodate any distance between .5 miles and 28 miles.</div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingFour">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrFour" aria-expanded="true" aria-controls="faq-rcrFour">How fast do I need to run?
                    </button>
                </h3>
                <div id="faq-rcrFour" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingFour"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        Also up to you. We'll plan based on your pace estimate, taking into account things like the elevation change and the street context as well. You may be scheduled to run more slowly than your preference to accommodate other runners.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingEleven">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrEleven" aria-expanded="true" aria-controls="faq-rcrEleven">How long is this going to take?
                    </button>
                </h3>
                <div id="faq-rcrEleven" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingEleven"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        <p>Depends on how long and where you want to run. The RCR team typically takes about 6.5 hours to complete the event (running from 08:30 to 15:00). If you have a hard time constraint, please include it in your registration comments.</p>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingFive">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrFive" aria-expanded="true" aria-controls="faq-rcrFive">Will I be too slow?
                    </button>
                </h3>
                <div id="faq-rcrFive" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingFive"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        No. We typically plan the legs through the downtown core only modestly faster than walking pace, so we'll have no problem accommodating a broad range of abilities.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingSix">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrSix" aria-expanded="true" aria-controls="faq-rcrSix">I'm unsure how fast or how far I can run.
                    </button>
                </h3>
                <div id="faq-rcrSix" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingSix"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        We recommend you join an <a href="{{ site.baseurl }}/">RCR weekday run</a> before the relay so that we can figure out
                        what's appropriate. This is especially important if you're new to running or if you're returning after a
                        long break.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingSeven">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrSeven" aria-expanded="true" aria-controls="faq-rcrSeven">I'm unsure about signing up because I don't know enough about where I'd be running.
                    </button>
                </h3>
                <div id="faq-rcrSeven" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingSeven"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        The organizers have run the course and put together some notes about what to expect along each leg, so do click around the route map. For the RCR team, multiple people will be assigned to each leg and at least one experienced runner will be in the group at all times. Please note any concerns or constraints on the open-ended part of the sign-up form so we can accommodate you.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingNine">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrNine" aria-expanded="true" aria-controls="faq-rcrNine">
                        Can I still sign up?
                    </button>
                </h3>
                <div id="faq-rcrNine" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingNine"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        The form will stay open until the Sunday before the event. Once it closes, the schedule won't be changed to accommodate your preferences, but you can join for any legs that you are able to. Please message us in the event Slack channel, #light-rail-relay-23, so we know to expect you.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h3 class="accordion-header" id="faq-rcr-headingTen">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq-rcrTen" aria-expanded="true" aria-controls="faq-rcrTen">
                        I want to update my preferences.
                    </button>
                </h3>
                <div id="faq-rcrTen" class="accordion-collapse collapse" aria-labelledby="faq-rcr-headingTen"
                     data-bs-parent="#faq-rcr-accordion">

                    <div class="accordion-body">
                        You can update your responses on the entry form until the weekend before the event. After that point, you can reduce or increase the number of legs that you run if it does not affect the pace schedule, otherwise there will be no changes.
                    </div>
                </div>
            </div>


        </div>
    </div>
</section>

<footer>
    <p class="imprint"><a href="{{ site.baseurl }}/"><img src="{{ site.baseurl }}/img/happy-toast.svg" alt="A happy piece of toast running"/></a></p>
</footer>
<script type="module">
    import { isMapboxURL, transformMapboxUrl } from "https://cdn.jsdelivr.net/npm/maplibregl-mapbox-request-transformer@0.0.2/src/index.min.js"
    import { relayToGPX, download, createCountdown, formatLegDescription, processRelayGeoJSON, createScheduleTable, createLegDetailsTable} from "../js/common.js";

    const mapboxKey = 'pk.eyJ1Ijoibmlja3N3YWxrZXIiLCJhIjoiY2t0ZjgyenE4MDR1YjJ1cno0N3hxYzI4YSJ9.ivPdsoEtV9TaLGbOOfFXKA'
    const transformRequest = (url, resourceType) => {
        if (isMapboxURL(url)) {
            return transformMapboxUrl(url, resourceType, mapboxKey)
        }
        return {url}
    }

    let routeData = fetch("{{ site.baseurl }}/maps/lrr22.geojson").then(res => res.json())
    let railData = fetch("{{ site.baseurl }}/maps/link-light-rail.geojson").then(res => res.json())
    let processedRouteData = routeData.then((relay) => {
        let [legs, exchanges] = processRelayGeoJSON(relay)
        let exchangeNames = new Array(exchanges.length);
        for (let exchange of exchanges.features) {
            exchangeNames[exchange.properties.id] = exchange.properties.name
        }
        return [legs, exchanges, exchangeNames]
    })


    processedRouteData.then(([legs, exchanges, exchangeNames]) => {
        let legsData = legs.features
        createLegDetailsTable(document.getElementById("leg-details-table"), legsData, exchanges.features)
        const downloadRouteButton = document.getElementById("download-route-gpx-btn")
        downloadRouteButton.addEventListener("click", event => {
            let gpxString = relayToGPX("Race Condition Running Light Rail Relay 2023", "Light Rail Relay 2023", legs.features, exchanges.features, 2023)
            download(gpxString, "application/gpx+xml", `light-rail-relay-2023.gpx`)
            event.preventDefault()
        })
        downloadRouteButton.hidden = false
    })

    fetch("{{ site.baseurl }}/maps/lrr23-map-style.json").then( res => res.json()).then(
        style => {
            let map = new maplibregl.Map({
                container: 'map-container', // container id
                attributionControl: false,
                style: style,
                center: [-122.32747365635417,47.60640473782326],
                zoom: 9,
                minZoom: 9,
                maxBounds: [[-122.90236980551624, 47.23422996598591], [-121.60263821424818, 47.83106353346886]],
                transformRequest: transformRequest
            });
            // Don't break basic page scrolling until the map is focused
            map.scrollZoom.disable()
            let container = document.getElementById("map-container")
            // container needs to have tabindex=0 to be focusable
            map.on("click", () => container.focus())
            map.on("pitchstart", () => container.focus())
            map.on("drag", () => container.focus())
            container.addEventListener('focus', () => map.scrollZoom.enable());
            container.addEventListener('blur', () => map.scrollZoom.disable());
            let nav = new maplibregl.NavigationControl();
            map.addControl(nav, 'top-left');
            map.addControl(new maplibregl.FullscreenControl({container: document.querySelector('map-container')}), 'top-left');
            map.addControl(new maplibregl.GeolocateControl({
                positionOptions: {
                    enableHighAccuracy: true
                },
                trackUserLocation: true
            }), 'top-left');
            let scale = new maplibregl.ScaleControl({
                maxWidth: 80,
                unit: 'imperial'
            });
            map.addControl(scale);
            map.addControl(new maplibregl.AttributionControl({
                compact: true
            }));
            Promise.all([
                new Promise((resolve, reject) => {
                    map.on('load', () => {
                        resolve();
                    })
                }),
                railData,
                processedRouteData
            ]).then(([_, railLines, [legs, exchanges, exchangeNames]]) => {
                let legsData = legs.features
                createLegDetailsTable(document.getElementById("leg-details-table"), legsData, exchanges.features)
                const relayBounds = legsData.reduce((bounds, leg) => leg.geometry.coordinates.reduce((bounds, coord) => {
                    return bounds.extend(coord);
                }, bounds), new maplibregl.LngLatBounds(legsData[0].geometry.coordinates[0], legsData[0].geometry.coordinates[0]));

                map.fitBounds(relayBounds, {
                    padding: 32
                });
                function hideAttribution() {
                    let attribution = document.querySelector(".maplibregl-compact-show")
                    if (attribution) {
                        attribution.classList.remove("maplibregl-compact-show")
                        attribution.classList.remove("mapboxgl-compact-show")
                    }
                }
                window.addEventListener("resize", function() {
                    if (window.innerWidth < 768) {
                        hideAttribution()
                    }
                })
                if (window.innerWidth < 768) {
                    hideAttribution()
                }

                map.addSource('route', {
                    'type': 'geojson',
                    'data': railLines
                })

                map.addLayer({
                    'id': 'route',
                    'type': 'line',
                    'source': 'route',
                    'layout': {
                        'line-join': 'round',
                        'line-cap': 'round'
                    },
                    'paint': {
                        'line-color': '#777',
                        'line-width': 1
                    }
                });
                map.addSource('legs', {
                    'type': 'geojson',
                    'generateId': true,
                    'data': legs
                });

                map.addLayer({
                    'id': 'legs',
                    'type': 'line',
                    'source': 'legs',
                    'layout': {
                        'line-join': 'round',
                        'line-cap': 'round'
                    },
                    'paint': {
                        'line-color': ['case', ['boolean', ['feature-state', 'selected'], false], '#468040', '#6cc462'],
                        'line-width': 8
                    }
                });
                map.addSource('exchanges', {
                    'type': 'geojson',
                    'generateId': true,
                    'data': exchanges
                });

                map.addLayer({
                    'id': 'exchange-circle',
                    'type': 'circle',
                    'source': 'exchanges',
                    minzoom: 9,
                    'paint': {
                        'circle-radius': 16,
                        'circle-color': '#fff'
                    }
                });

                map.addLayer({
                    id: 'exchange-id',
                    type: 'symbol',
                    source: 'exchanges',
                    minzoom: 9,
                    layout: {
                        'text-field': '{id}',
                        'text-font': ['Open Sans Semibold'],
                        'text-size': 16
                    }
                });

                let currentExchangePopup = null;
                let currentHoveredExchange = null;
                let exchangePinned = false;
                // When a click event occurs on a feature in the places layer, open a popup at the
                // location of the feature, with description HTML from its properties.

                function addExchangePopup(feature) {
                    return new maplibregl.Popup({offset: [16, 0], className: "exchange-name-popup", focusAfterOpen: false, closeButton: false, anchor: 'left'})
                        .setLngLat(feature.geometry.coordinates)
                        .setHTML(`<h5 class="m-0"><a href="${feature.properties.stationInfo}" title="Official station page" target="_new">${feature.properties.name} 🔗</a></h5>`)
                        .setMaxWidth("350px")
                        .addTo(map);
                }

                map.on('click', 'exchange-circle', e => {
                    const exchange = e.features[0]
                    e.originalEvent.stopPropagation()

                    currentExchangePopup = addExchangePopup(exchange)
                    if (currentHoveredExchange) {
                        map.setFeatureState(
                            {source: 'exchanges', id: currentHoveredExchange},
                            {hover: false}
                        );
                    }
                    map.setFeatureState(
                        {source: 'exchanges', id: exchange.id},
                        {hover: true}
                    );
                    exchangePinned = true
                    currentHoveredExchange = exchange.id
                })
                map.on('mousemove', 'exchange-circle', (e) => {
                    if (exchangePinned && currentExchangePopup && currentExchangePopup.isOpen()) {
                        return
                    }
                    if (e.features.length > 0) {
                        let feature = e.features[0]
                        if (currentExchangePopup && currentExchangePopup.isOpen()) {
                            if (currentHoveredExchange === feature.properties.id) {
                                return
                            }
                            currentExchangePopup.remove()
                        }

                        currentHoveredExchange = feature.properties.id;
                        currentExchangePopup = addExchangePopup(feature)
                    } else if (currentExchangePopup) {
                        currentExchangePopup.remove()
                        currentExchangePopup = null
                        currentHoveredExchange = null
                        exchangePinned = false;
                    }
                });

                map.on("mouseenter", "exchange-circle", (e) => {
                    map.getCanvas().style.cursor = 'pointer';
                });

                // Change it back to a pointer when it leaves.
                map.on('mouseleave', 'exchange-circle', (e) => {
                    map.getCanvas().style.cursor = '';
                    e.preventDefault()
                });

                let currentActiveLeg = null
                let currentLegPopup = null
                map.on('click', 'legs', (e) => {
                    const coordinates = e.features[0].geometry.coordinates;
                    const leg = e.features[0]
                    const bounds = coordinates.reduce((bounds, coord) => {
                        return bounds.extend(coord);
                    }, new maplibregl.LngLatBounds(coordinates[0], coordinates[0]));
                    currentLegPopup = new maplibregl.Popup({anchor: "bottom-left", offset:[16, 0], className: "leg-popup", focusAfterOpen: true})
                        .setLngLat([bounds.getEast(), bounds.getCenter().lat])
                        .setMaxWidth("300px")
                        .setHTML(formatLegDescription(exchangeNames[leg.properties.start_exchange], exchangeNames[leg.properties.end_exchange], leg.properties))
                        .on("close", () => {
                            map.setFeatureState(
                                {source: 'legs', id: leg.id},
                                {selected: false}
                            );
                            currentActiveLeg = null
                            container.focus()
                        })
                        .addTo(map);
                    map.fitBounds(bounds, {
                        padding: 32
                    });
                    if (currentActiveLeg) {
                        map.setFeatureState(
                            {source: 'legs', id: currentActiveLeg.id},
                            {selected: false}
                        );
                    }
                    map.setFeatureState(
                        {source: 'legs', id: leg.id},
                        {selected: true}
                    );
                    currentActiveLeg = leg
                })

                // Change the cursor to a pointer when the mouse is over the places layer.
                map.on('mouseenter', 'legs', () => {
                    map.getCanvas().style.cursor = 'pointer';

                });

                // Change it back to a pointer when it leaves.
                map.on('mouseleave', 'legs', () => {
                    map.getCanvas().style.cursor = '';
                });
            });

        }
    )

    let startTime = new Date("Sept 30, 2023 8:30:00")
    /*fetch('{{ site.baseurl }}/maps/lrr23-schedule.json')
        .then(res => res.json())
        .then(schedule => {
            createScheduleTable("#schedule-table", schedule, startTime)
        })*/

    createCountdown(startTime.getTime(), "countdown-ended")

    processedRouteData.then( ([legs, exchanges, exchangeNames]) => {
        document.getElementById("leg-calculator").style.display = ""
        let valuesSlider = document.getElementById('leg-calculator-slider');
        let cumulativeDistances = [0]
        let cumulativeAscents = [0]
        let cumulativeDescents = [0]
        for (let i = 1; i < legs.features.length + 1; i++) {
            let leg = legs.features[i - 1]
            cumulativeDistances.push(cumulativeDistances[i - 1] + leg.properties.distance_mi)
            cumulativeAscents.push(cumulativeAscents[i - 1] + leg.properties.ascent_ft)
            cumulativeDescents.push(cumulativeDescents[i - 1] + leg.properties.descent_ft)
        }

        function bisectLeft(arr, value, lo=0, hi=arr.length) {
            while (lo < hi) {
                const mid = (lo + hi) >> 1;
                if (arr[mid] < value) {
                    lo = mid + 1;
                } else {
                    hi = mid;
                }
            }
            return lo;
        }

        let formatToStationNumber = {
            to: function(value) {
                return bisectLeft(cumulativeDistances, value);
            },
            from: function (value) {
                return cumulativeDistances[Math.round(value)];
            }
        };

        let steppedRange = {}
        for (let i = 0; i < cumulativeDistances.length - 1; i++) {
            let percentage = cumulativeDistances[i] / cumulativeDistances[cumulativeDistances.length - 1]
            steppedRange[`${percentage * 100}%`] = cumulativeDistances[i]
        }
        steppedRange["min"] = 0
        steppedRange["max"] = cumulativeDistances[cumulativeDistances.length - 1]
        let slider = noUiSlider.create(valuesSlider, {
            start: ["4", "12"],
            range: steppedRange,
            margin: .5,
            tooltips: true,
            snap: true,
            connect: true,
            format: formatToStationNumber,
            pips: {
                mode: 'range',
                density: 50,
                format: formatToStationNumber
            }
        });


        let leftValue = 4
        let rightValue = 12
        // The display values can be used to control the slider
        slider.set(['4', '12']);
        slider.on('update', function (values, handle, unencoded) {
            let oldLeft = leftValue
            let oldRight = rightValue
            if (handle === 0) {
                leftValue = values[handle]
            } else {
                rightValue = values[handle]
            }
            if (leftValue === rightValue) {
                if (handle === 0) {
                    leftValue = oldLeft
                    slider.set([leftValue, rightValue])
                } else {
                    rightValue = oldRight
                    slider.set([leftValue, rightValue])
                }
                return
            }
            let distance = cumulativeDistances[rightValue] - cumulativeDistances[leftValue]
            let ascent = cumulativeAscents[rightValue] - cumulativeAscents[leftValue]
            let descent = cumulativeDescents[rightValue] - cumulativeDescents[leftValue]
            let legName = `${exchangeNames[leftValue]} to ${exchangeNames[rightValue]}`
            // "values" has the "to" function from "format" applied
            // "unencoded" contains the raw numerical slider values
            let legDesc = `<div class="d-flex flex-column flex-lg-row justify-content-between align-items-baseline"><h5>${legName}</h5><h6>${distance.toFixed(2)}mi ↑${ascent.toFixed(0)}ft ↓${descent.toFixed(0)}ft</h6></div>`
            document.getElementById("leg-calculator-description").innerHTML = legDesc
        });
    })

    // Tooltips for sign-up deadlines
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
</script>

</body>
</html>